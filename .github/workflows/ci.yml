name: CI/CD Pipeline - Insurance ML App

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  backend-ci:
    name: Backend CI (FastAPI)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install Backend Dependencies
        run: |
          cd backend
          pip install --upgrade pip
          pip install -r requirements_backend.txt

      - name: Backend Import Check
        run: |
          cd backend
          python - <<EOF
          import main
          print("Backend imports successful")
          EOF

  frontend-ci:
    name: Frontend CI (Streamlit)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install Frontend Dependencies
        run: |
          cd frontend
          pip install --upgrade pip
          pip install -r requirements_frontend.txt

      - name: Frontend Import Check
        run: |
          cd frontend
          python - <<EOF
          import streamlit
          print("Frontend imports successful")
          EOF
